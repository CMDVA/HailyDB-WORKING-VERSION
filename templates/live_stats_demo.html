<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HailyDB Live Statistics</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 40px;
            font-size: 2.5rem;
        }
        
        .readme-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
            border-left: 4px solid #3498db;
        }
        
        .readme-section h2 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .readme-section ul {
            list-style: none;
            padding: 0;
        }
        
        .readme-section li {
            padding: 8px 0;
            font-size: 1.1rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .readme-section li:last-child {
            border-bottom: none;
        }
        
        .updated {
            animation: highlight 1s ease-in-out;
        }
        
        @keyframes highlight {
            0% { background-color: #fff3cd; }
            100% { background-color: transparent; }
        }
        
        .control-panel {
            text-align: center;
            margin: 30px 0;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0 10px;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .toggle-btn {
            background: #e74c3c;
        }
        
        .toggle-btn:hover {
            background: #c0392b;
        }
        
        #live-dashboard-container {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üå©Ô∏è HailyDB Live Statistics Demo</h1>
        
        <div class="readme-section">
            <h2>Production Statistics (README Format)</h2>
            <ul>
                <li>üìä <strong><span id="total-alerts">Loading...</span> Total NWS Alerts</strong> with comprehensive enrichments</li>
                <li>‚õàÔ∏è <strong><span id="spc-reports">Loading...</span> SPC Storm Reports</strong> with 100% historical coverage</li>
                <li>üéØ <strong><span id="radar-detected">Loading...</span> Radar-Detected Events</strong> pre-filtered for damage assessment</li>
                <li>‚úÖ <strong>100% Data Integrity</strong> with continuous verification against official sources</li>
            </ul>
            <div id="stats-last-updated" style="font-size: 0.9em; color: #666; margin-top: 12px;"></div>
        </div>
        
        <div class="control-panel">
            <button onclick="liveStats.updateReadmeStats()">üîÑ Refresh README Stats</button>
            <button id="toggle-dashboard" class="toggle-btn" onclick="toggleDashboard()">üìä Show Live Dashboard</button>
            <button onclick="liveStats.cache = {}; liveStats.updateReadmeStats()">‚ö° Force Refresh (Clear Cache)</button>
        </div>
        
        <!-- Live Dashboard Container -->
        <div id="live-dashboard-container"></div>
        
        <div style="margin-top: 40px; padding: 20px; background: #e8f4f8; border-radius: 8px;">
            <h3>üí° Implementation Notes</h3>
            <ul>
                <li><strong>Automatic Updates</strong>: Statistics refresh every 5 minutes automatically</li>
                <li><strong>API Endpoint</strong>: <code>/api/stats/summary</code> provides optimized real-time data</li>
                <li><strong>Caching</strong>: 5-minute cache prevents unnecessary database load</li>
                <li><strong>Fallback</strong>: Graceful error handling with cached data when API unavailable</li>
                <li><strong>Performance</strong>: Single SQL query fetches all statistics efficiently</li>
            </ul>
        </div>
    </div>

    <script src="/static/js/live-stats.js"></script>
    <script>
        function toggleDashboard() {
            const container = document.getElementById('live-dashboard-container');
            const button = document.getElementById('toggle-dashboard');
            
            if (container.innerHTML.trim() === '') {
                // Show dashboard
                liveStats.createLiveDashboard('live-dashboard-container');
                button.textContent = 'üôà Hide Live Dashboard';
                button.classList.remove('toggle-btn');
            } else {
                // Hide dashboard
                container.innerHTML = '';
                button.textContent = 'üìä Show Live Dashboard';
                button.classList.add('toggle-btn');
            }
        }
        
        // Show a notification when stats update
        document.addEventListener('DOMContentLoaded', () => {
            const observer = new MutationObserver(() => {
                console.log('Statistics updated with live data from autonomous system');
            });
            
            const alertsElement = document.getElementById('total-alerts');
            if (alertsElement) {
                observer.observe(alertsElement, { childList: true, characterData: true, subtree: true });
            }
        });
    </script>
</body>
</html>