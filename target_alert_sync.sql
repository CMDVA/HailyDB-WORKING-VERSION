-- Target Alert Sync SQL
-- Run this against your production database


INSERT INTO alerts (id, event, severity, area_desc, effective, expires, sent, geometry, properties, raw, ai_summary, ai_tags, spc_verified, spc_reports, spc_confidence_score, spc_match_method, spc_report_count, spc_ai_summary, radar_indicated, fips_codes, county_names, city_names, geometry_type, coordinate_count, affected_states, geometry_bounds, ingested_at, updated_at, location_confidence) 
VALUES ('urn:oid:2.49.0.1.840.0.47199d556c7667ca8d58be1f58db503767724a66.001.1', 'Special Weather Statement', 'Moderate', 'Pinellas; Coastal Hillsborough; Inland Pasco; Inland Hillsborough', '2025-08-19 23:33:00', '2025-08-20 00:15:00', '2025-08-19 23:33:00', '{"type": "Polygon", "coordinates": [[[-82.58, 28.25], [-82.35, 28.21], [-82.36999999999999, 27.93], [-82.55999999999999, 27.9], [-82.69999999999999, 27.979999999999997], [-82.58, 28.25]]]}'::jsonb, '{"id": "urn:oid:2.49.0.1.840.0.47199d556c7667ca8d58be1f58db503767724a66.001.1", "@id": "https://api.weather.gov/alerts/urn:oid:2.49.0.1.840.0.47199d556c7667ca8d58be1f58db503767724a66.001.1", "web": "http://www.weather.gov", "code": "IPAWSv1.0", "ends": null, "sent": "2025-08-19T19:33:00-04:00", "@type": "wx:Alert", "event": "Special Weather Statement", "onset": "2025-08-19T19:33:00-04:00", "scope": "Public", "sender": "w-nws.webmaster@noaa.gov", "status": "Actual", "expires": "2025-08-19T20:15:00-04:00", "geocode": {"UGC": ["FLZ050", "FLZ151", "FLZ249", "FLZ251"], "SAME": ["012103", "012057", "012101"]}, "urgency": "Expected", "areaDesc": "Pinellas; Coastal Hillsborough; Inland Pasco; Inland Hillsborough", "category": "Met", "headline": "Special Weather Statement issued August 19 at 7:33PM EDT by NWS Tampa Bay Ruskin FL", "language": "en-US", "response": "Execute", "severity": "Moderate", "certainty": "Observed", "effective": "2025-08-19T19:33:00-04:00", "eventCode": {"SAME": ["SPS"], "NationalWeatherService": ["SPS"]}, "parameters": {"EAS-ORG": ["WXR"], "NWSheadline": ["A STRONG THUNDERSTORM WILL IMPACT SOUTH CENTRAL PASCO... NORTHEASTERN PINELLAS AND NORTHWESTERN HILLSBOROUGH COUNTIES THROUGH 815 PM EDT"], "maxHailSize": ["0.50"], "maxWindGust": ["50 MPH"], "BLOCKCHANNEL": ["EAS", "NWEM", "CMAS"], "WMOidentifier": ["WWUS82 KTBW 192333"], "AWIPSidentifier": ["SPSTBW"], "eventMotionDescription": ["2025-08-19T23:33:00-00:00...storm...014DEG...12KT...28.1,-82.49"]}, "references": [], "senderName": "NWS Tampa Bay Ruskin FL", "description": "At 733 PM EDT, Doppler radar was tracking a strong thunderstorm over\nLake Magdalene, or near Lutz, moving south at 15 mph.\n\nHAZARD...Wind gusts up to 50 mph and half inch hail.\n\nSOURCE...Radar indicated.\n\nIMPACT...Gusty winds could knock down tree limbs and blow around\nunsecured objects. Minor hail damage to vegetation is\npossible.\n\nLocations impacted include...\nBusch Gardens, University Of Tampa, Lutz, Odessa, New Tampa,\nKeystone, Greater Northdale, Town N Country, Lettuce Lake Park, Tampa\nInternational Airport, Cheval, Orient Park, East Lake-Orient Park,\nRaymond James Stadium, Ybor City, Westchase, West Park, Soho, Wesley\nChapel, and Land O Lakes.", "instruction": "If outdoors, consider seeking shelter inside a building.", "messageType": "Alert", "affectedZones": ["https://api.weather.gov/zones/forecast/FLZ050", "https://api.weather.gov/zones/forecast/FLZ151", "https://api.weather.gov/zones/forecast/FLZ249", "https://api.weather.gov/zones/forecast/FLZ251"]}'::jsonb, '{"id": "https://api.weather.gov/alerts/urn:oid:2.49.0.1.840.0.47199d556c7667ca8d58be1f58db503767724a66.001.1", "type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-82.58, 28.25], [-82.35, 28.21], [-82.36999999999999, 27.93], [-82.55999999999999, 27.9], [-82.69999999999999, 27.979999999999997], [-82.58, 28.25]]]}, "properties": {"id": "urn:oid:2.49.0.1.840.0.47199d556c7667ca8d58be1f58db503767724a66.001.1", "@id": "https://api.weather.gov/alerts/urn:oid:2.49.0.1.840.0.47199d556c7667ca8d58be1f58db503767724a66.001.1", "web": "http://www.weather.gov", "code": "IPAWSv1.0", "ends": null, "sent": "2025-08-19T19:33:00-04:00", "@type": "wx:Alert", "event": "Special Weather Statement", "onset": "2025-08-19T19:33:00-04:00", "scope": "Public", "sender": "w-nws.webmaster@noaa.gov", "status": "Actual", "expires": "2025-08-19T20:15:00-04:00", "geocode": {"UGC": ["FLZ050", "FLZ151", "FLZ249", "FLZ251"], "SAME": ["012103", "012057", "012101"]}, "urgency": "Expected", "areaDesc": "Pinellas; Coastal Hillsborough; Inland Pasco; Inland Hillsborough", "category": "Met", "headline": "Special Weather Statement issued August 19 at 7:33PM EDT by NWS Tampa Bay Ruskin FL", "language": "en-US", "response": "Execute", "severity": "Moderate", "certainty": "Observed", "effective": "2025-08-19T19:33:00-04:00", "eventCode": {"SAME": ["SPS"], "NationalWeatherService": ["SPS"]}, "parameters": {"EAS-ORG": ["WXR"], "NWSheadline": ["A STRONG THUNDERSTORM WILL IMPACT SOUTH CENTRAL PASCO... NORTHEASTERN PINELLAS AND NORTHWESTERN HILLSBOROUGH COUNTIES THROUGH 815 PM EDT"], "maxHailSize": ["0.50"], "maxWindGust": ["50 MPH"], "BLOCKCHANNEL": ["EAS", "NWEM", "CMAS"], "WMOidentifier": ["WWUS82 KTBW 192333"], "AWIPSidentifier": ["SPSTBW"], "eventMotionDescription": ["2025-08-19T23:33:00-00:00...storm...014DEG...12KT...28.1,-82.49"]}, "references": [], "senderName": "NWS Tampa Bay Ruskin FL", "description": "At 733 PM EDT, Doppler radar was tracking a strong thunderstorm over\nLake Magdalene, or near Lutz, moving south at 15 mph.\n\nHAZARD...Wind gusts up to 50 mph and half inch hail.\n\nSOURCE...Radar indicated.\n\nIMPACT...Gusty winds could knock down tree limbs and blow around\nunsecured objects. Minor hail damage to vegetation is\npossible.\n\nLocations impacted include...\nBusch Gardens, University Of Tampa, Lutz, Odessa, New Tampa,\nKeystone, Greater Northdale, Town N Country, Lettuce Lake Park, Tampa\nInternational Airport, Cheval, Orient Park, East Lake-Orient Park,\nRaymond James Stadium, Ybor City, Westchase, West Park, Soho, Wesley\nChapel, and Land O Lakes.", "instruction": "If outdoors, consider seeking shelter inside a building.", "messageType": "Alert", "affectedZones": ["https://api.weather.gov/zones/forecast/FLZ050", "https://api.weather.gov/zones/forecast/FLZ151", "https://api.weather.gov/zones/forecast/FLZ249", "https://api.weather.gov/zones/forecast/FLZ251"]}}'::jsonb, NULL, NULL, 'False', NULL, NULL, NULL, '0', NULL, '{"wind_mph": 50, "hail_inches": 0.5}'::jsonb, '[]'::jsonb, '[]'::jsonb, NULL, 'Polygon', '6', '["FL"]'::jsonb, '{"max_lat": 28.25, "max_lon": -82.35, "min_lat": 27.9, "min_lon": -82.69999999999999}'::jsonb, '2025-08-19 23:35:15.338002', '2025-08-19 23:55:07.189840', NULL) 
ON CONFLICT (id) DO UPDATE SET
    event = EXCLUDED.event,
    radar_indicated = EXCLUDED.radar_indicated,
    properties = EXCLUDED.properties,
    geometry = EXCLUDED.geometry,
    updated_at = NOW();
